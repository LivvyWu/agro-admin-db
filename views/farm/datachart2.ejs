<!DOCTYPE html>
<html>
<head>
    <% include ../head.ejs %>
    <!-- Morris charts -->
    <link rel="stylesheet" href="/plugins/morris/morris.css">
    <style>
        .liquidFillGaugeText {
            font-family: Helvetica;
            font-weight: bold;
        }
    </style>
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">
    <% include ../navigation.ejs %>
    <% include ../sidebar.ejs %>

    <div class="content-wrapper">
        <section class="content-header">
            <h1>
                量測資料
                <small>濕度計</small>
            </h1>
            <ol class="breadcrumb">
                <li><a href="#"><i class="fa fa-dashboard"></i> 首頁</a></li>
                <li><a href="#">農場</a></li>
                <li><a href="#">農場環控</a></li>
                <li class="active">量測資料</li>
            </ol>
        </section>

        <section class="content">
            <div class="callout callout-success">
                <h4><i class="icon fa fa-check"></i> 無警示</h4>

                <p><b>專家建議</b>無 - 2016.11.2 13:30</p>
            </div>

            <div class="row">
                <div class="col-xs-12">
                    <div class="nav-tabs-custom">
                        <ul class="nav nav-tabs">
                            <li class="active"><a href="#tab_1" data-toggle="tab">一號濕度計</a></li>
                            <li><a href="#tab_2" data-toggle="tab">二號濕度計</a></li>
                            <li><a href="#tab_3" data-toggle="tab">三號濕度計</a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tab_1">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="box">
                                            <div class="box-header">
                                                <h3 class="box-title">一號農場一號濕度計歷史資料表</h3>
                                                <div class="box-tools pull-right">
                                                    <button type="button" class="btn btn-box-tool"
                                                            data-widget="collapse"><i class="fa fa-minus"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-box-tool" data-widget="remove">
                                                        <i class="fa fa-times"></i></button>
                                                </div>
                                            </div>
                                            <div class="box-body">
                                                <table id="example1" class="display table table-bordered table-striped">
                                                    <thead>
                                                    <tr>
                                                        <th>日期</th>
                                                        <th>數值(攝氏度)</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <% for(var i = 0; i < 500; i++) { %>
                                                    <tr>
                                                        <td><%= moment().subtract(i, 'day').format('YYYY-MM-DD') %></td>
                                                        <td><%= (Math.random() * (40 - 5) + 5 ).toFixed(2) %></td>
                                                    </tr>
                                                    <% } %>
                                                    </tfoot>
                                                </table>
                                            </div>
                                            <!-- /.box-body -->
                                        </div>
                                        <!-- /.box -->
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="box box-primary">
                                            <div class="box-header with-border">
                                                <h3 class="box-title">一號農場一號濕度計歷史紀錄圖</h3>

                                                <div class="box-tools pull-right">
                                                    <button type="button" class="btn btn-box-tool"
                                                            data-widget="collapse"><i class="fa fa-minus"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-box-tool" data-widget="remove">
                                                        <i class="fa fa-times"></i></button>
                                                </div>
                                            </div>
                                            <div class="box-body chart-responsive">
                                                <div class="chart" id="line-chart" style="height: 300px;"></div>
                                            </div>
                                            <!-- /.box-body -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tab_2">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="box">
                                            <div class="box-header">
                                                <h3 class="box-title">一號農場二號濕度計歷史資料表</h3>
                                                <div class="box-tools pull-right">
                                                    <button type="button" class="btn btn-box-tool"
                                                            data-widget="collapse"><i class="fa fa-minus"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-box-tool" data-widget="remove">
                                                        <i class="fa fa-times"></i></button>
                                                </div>
                                            </div>
                                            <div class="box-body">
                                                <table id="example2" class="display table table-bordered table-striped">
                                                    <thead>
                                                    <tr>
                                                        <th>日期</th>
                                                        <th>數值(攝氏度)</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <% for(var i = 0; i < 500; i++) { %>
                                                    <tr>
                                                        <td><%= moment().subtract(i, 'day').format('YYYY-MM-DD') %></td>
                                                        <td><%= (Math.random() * (40 - 5) + 5 ).toFixed(2) %></td>
                                                    </tr>
                                                    <% } %>
                                                    </tfoot>
                                                </table>
                                            </div>
                                            <!-- /.box-body -->
                                        </div>
                                        <!-- /.box -->
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="box box-primary">
                                            <div class="box-header with-border">
                                                <h3 class="box-title">一號農場二號濕度計歷史紀錄圖</h3>

                                                <div class="box-tools pull-right">
                                                    <button type="button" class="btn btn-box-tool"
                                                            data-widget="collapse"><i class="fa fa-minus"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-box-tool" data-widget="remove">
                                                        <i class="fa fa-times"></i></button>
                                                </div>
                                            </div>
                                            <div class="box-body chart-responsive">
                                                <div class="chart" id="line-chart1" style="height: 300px;"></div>
                                            </div>
                                            <!-- /.box-body -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tab_3">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="box">
                                            <div class="box-header">
                                                <h3 class="box-title">一號農場三號濕度計歷史資料表</h3>
                                                <div class="box-tools pull-right">
                                                    <button type="button" class="btn btn-box-tool"
                                                            data-widget="collapse"><i class="fa fa-minus"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-box-tool" data-widget="remove">
                                                        <i class="fa fa-times"></i></button>
                                                </div>
                                            </div>
                                            <div class="box-body">
                                                <table id="example3" class="display table table-bordered table-striped">
                                                    <thead>
                                                    <tr>
                                                        <th>日期</th>
                                                        <th>數值(攝氏度)</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <% for(var i = 0; i < 500; i++) { %>
                                                    <tr>
                                                        <td><%= moment().subtract(i, 'day').format('YYYY-MM-DD') %></td>
                                                        <td><%= (Math.random() * (40 - 5) + 5 ).toFixed(2) %></td>
                                                    </tr>
                                                    <% } %>
                                                    </tfoot>
                                                </table>
                                            </div>
                                            <!-- /.box-body -->
                                        </div>
                                        <!-- /.box -->
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="box box-primary">
                                            <div class="box-header with-border">
                                                <h3 class="box-title">一號農場三號濕度計歷史紀錄圖</h3>

                                                <div class="box-tools pull-right">
                                                    <button type="button" class="btn btn-box-tool"
                                                            data-widget="collapse"><i class="fa fa-minus"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-box-tool" data-widget="remove">
                                                        <i class="fa fa-times"></i></button>
                                                </div>
                                            </div>
                                            <div class="box-body chart-responsive">
                                                <div class="chart" id="line-chart2" style="height: 300px;"></div>
                                            </div>
                                            <!-- /.box-body -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-12">
                    <div class="box box-solid">
                        <div class="box-header">
                            <!--<i class="fa fa-bar-chart-o"></i>-->

                            <h3 class="box-title"></h3>

                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-default btn-sm" data-widget="collapse"><i
                                            class="fa fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-default btn-sm" data-widget="remove"><i
                                            class="fa fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="row">
                                <div class="col-xs-3 text-center">

                                    <svg class="img-fluid" id="fillgauge0"
                                         onclick="gauge0.update(NewValue());"></svg>
                                    <div class="knob-label">標準數值</div>
                                </div>

                                <div class="col-xs-3 text-center">
                                    <svg class="img-fluid" id="fillgauge1"
                                         onclick="gauge1.update(NewValue());"></svg>
                                    <div class="knob-label">一號濕度計目前濕度</div>
                                </div>

                                <div class="col-xs-3 text-center">
                                    <svg class="img-fluid" id="fillgauge2"
                                         onclick="gauge2.update(NewValue());"></svg>
                                    <div class="knob-label">二號濕度計目前濕度</div>
                                </div>

                                <div class="col-xs-3 text-center">
                                    <svg class="img-fluid" id="fillgauge3"
                                         onclick="gauge3.update(NewValue());"></svg>
                                    <div class="knob-label">三號濕度計目前濕度</div>
                                </div>

                            </div>
                            <!-- /.row -->

                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </div>

            </div>

            <!-- callout -->
            <div class="callout callout-info">
                <h4>查看農場環控歷史統計資料 <a href="/farm/sensorRecord">前往<i class="fa fa-arrow-circle-right"></i></a></h4>
            </div>
            <!-- /.callout -->

            <div class="row">
                <div class="col-xs-12">
                    <!-- interactive chart -->
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <i class="fa fa-bar-chart-o"></i>

                            <h3 class="box-title">農場濕度 即時監控</h3>

                            <div class="box-tools pull-right">
                                即時
                                <div class="btn-group" id="realtime" data-toggle="btn-toggle">
                                    <button type="button" class="btn btn-default btn-xs active" data-toggle="on">開
                                    </button>
                                    <button type="button" class="btn btn-default btn-xs" data-toggle="off">關</button>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <div id="interactive" style="height: 300px;"></div>
                        </div>
                        <!-- /.box-body-->
                    </div>
                    <!-- /.box -->

                </div>
                <!-- /.col -->


            </div>
            <!-- /.row -->

            <!-- callout -->
            <div class="callout callout-info">
                <h4>查看其他感測器資料 <a href="/farm/info">前往<i class="fa fa-arrow-circle-right"></i></a></h4>
            </div>
            <!-- /.callout -->


        </section>
    </div>
</div>

<!-- jQuery 2.2.3 -->
<script src="/plugins/jQuery/jquery-2.2.3.min.js"></script>
<!-- Bootstrap 3.3.6 -->
<script src="/bootstrap/js/bootstrap.min.js"></script>
<!-- ChartJS 1.0.1 -->
<script src="/plugins/chartjs/Chart.min.js"></script>
<!-- FastClick -->
<script src="/plugins/fastclick/fastclick.js"></script>

<!-- jQuery Knob -->
<script src="/plugins/knob/jquery.knob.js"></script>
<!-- Sparkline -->
<script src="/plugins/sparkline/jquery.sparkline.min.js"></script>

<!-- FLOT CHARTS -->
<script src="/plugins/flot/jquery.flot.min.js"></script>
<!-- FLOT RESIZE PLUGIN - allows the chart to redraw when the window is resized -->
<script src="/plugins/flot/jquery.flot.resize.min.js"></script>
<!-- FLOT PIE PLUGIN - also used to draw donut charts -->
<script src="/plugins/flot/jquery.flot.pie.min.js"></script>
<script src="/plugins/flot/jquery.flot.time.min.js"></script>
<script src="/plugins/flot/jquery.flot.axislabels.js"></script>
<!-- FLOT CATEGORIES PLUGIN - Used to draw bar charts -->
<script src="/plugins/flot/jquery.flot.categories.min.js"></script>

<!-- Morris.js charts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="/plugins/morris/morris.min.js"></script>

<!-- DataTables -->
<script src="/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="/plugins/datatables/dataTables.bootstrap.min.js"></script>
<!-- D3 -->
<!--<script src="http://d3js.org/d3.v3.min.js" language="JavaScript"></script>-->
<script src="/plugins/d3/d3.min.js"></script>
<script src="/plugins/d3/liquidFillGauge.js"></script>

<!-- AdminLTE App -->
<script src="/js/app.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="/js/demo.js"></script>

<script>

    $(function () {

        $.each(['#example1', '#example2', '#example3'], function(index, elm){
            $(elm).DataTable({
                "paging": true,
                "pagingType": "simple",
                "lengthChange": true,
                "searching": false,
                "ordering": true,
                "info": true,
                "autoWidth": false,
                "oLanguage": {
                    "sLengthMenu": "顯示 _MENU_ 筆記錄",
                    "sZeroRecords": "無符合資料",
                    "sInfo": "目前記錄：_START_ 至 _END_, 總筆數：_TOTAL_",
                    "oPaginate": {
                        "sPrevious": "上頁",
                        "sNext": "下頁"
                    }
                }
            });
        });

        var morrisData = [
            {day: '2016-10-1', item1: 25},
            {day: '2016-10-2', item1: 26},
            {day: '2016-10-3', item1: 27},
            {day: '2016-10-4', item1: 27},
            {day: '2016-10-5', item1: 29},
            {day: '2016-10-6', item1: 22},
            {day: '2016-10-7', item1: 21},
            {day: '2016-10-8', item1: 28},
            {day: '2016-10-9', item1: 30},
            {day: '2016-10-10', item1: 29},
            {day: '2016-10-11', item1: 30},
            {day: '2016-10-12', item1: 28},
            {day: '2016-10-13', item1: 26},
            {day: '2016-10-14', item1: 24},
            {day: '2016-10-15', item1: 22},
            {day: '2016-10-16', item1: 20},
            {day: '2016-10-17', item1: 25},
            {day: '2016-10-18', item1: 27},
            {day: '2016-10-19', item1: 31}

        ]

        // LINE CHART
        var linechart = new Morris.Line({
            element: 'line-chart',
            resize: true,
            data: morrisData,
            xkey: 'day',
            ykeys: ['item1'],
            labels: ['溫度'],
            lineColors: ['#f56954'],
            hideHover: 'auto',
            xLabelFormat: function (x) {
                var d = new Date(x);
                return d.getFullYear() + '/' + (d.getMonth() + 1) + "/" + (d.getDate());
            }
        });

        // LINE CHART
        var linechart1 = new Morris.Line({
            element: 'line-chart1',
            resize: true,
            data: morrisData,
            xkey: 'day',
            ykeys: ['item1'],
            labels: ['溫度'],
            lineColors: ['#f56954'],
            hideHover: 'auto',
            xLabelFormat: function (x) {
                var d = new Date(x);
                return d.getFullYear() + '/' + (d.getMonth() + 1) + "/" + (d.getDate());
            }
        });

        // LINE CHART
        var linechart2 = new Morris.Line({
            element: 'line-chart2',
            resize: true,
            data: morrisData,
            xkey: 'day',
            ykeys: ['item1'],
            labels: ['溫度'],
            lineColors: ['#f56954'],
            hideHover: 'auto',
            xLabelFormat: function (x) {
                var d = new Date(x);
                return d.getFullYear() + '/' + (d.getMonth() + 1) + "/" + (d.getDate());
            }
        });

        $('ul.nav a').on('shown.bs.tab', function (e) {
//            linechart.redraw();
            linechart1.redraw();
            linechart2.redraw();
        });

        /*
         * Flot Interactive Chart
         * -----------------------
         */
        // We use an inline data source in the example, usually data would
        // be fetched from a server
        var data = [], totalPoints = 60;

        function getRandomData() {

            if (data.length > 0)
                data = data.slice(1);

            // Do a random walk
            while (data.length < totalPoints) {

                var prev = data.length > 0 ? data[data.length - 1] : 60,
                        y = prev + Math.random() * 10 - 5;

                if (y < 0) {
                    y = 0;
                } else if (y > 100) {
                    y = 90;
                }

                data.push(y);
            }

            // Zip the generated y values with the x values
            var res = [];
            var now = new Date();
            for (var i = 0; i < data.length; ++i) {
                var sub = now.getTime() - 1000*60*10*i;
                res.push([now.setTime(sub), data[i]]);
            }

            return res;
        }

        var interactive_plot = $.plot("#interactive", [getRandomData()], {
            grid: {
                borderColor: "#f3f3f3",
                borderWidth: 3,
                tickColor: "#f3f3f3"
            },
            series: {
                shadowSize: 0, // Drawing is faster without shadows
                color: "#3c8dbc"
            },
            lines: {
                fill: true, //Converts the line chart to area chart
                color: "#3c8dbc"
            },
            yaxis: {
                min: 0,
                max: 100,
                show: true,
                axisLabel: '濕度(%)',
            },
            xaxis: {
                show: true,
                mode: "time",
                axisLabel: '時間',
                minTickSize: [1, "second"],
                timeformat: "%Y/%m/%d"
            },
            legend: {
                position: "nw",
                labelBoxBorderColor: null
            }
        });

        var updateInterval = 1000; //Fetch data ever x milliseconds
        var realtime = "on"; //If == to on then fetch data every x seconds. else stop fetching
        function update() {

            interactive_plot.setData([getRandomData()]);

            // Since the axes don't change, we don't need to call plot.setupGrid()
            interactive_plot.draw();
            if (realtime === "on")
                setTimeout(update, updateInterval);
        }

        //INITIALIZE REALTIME DATA FETCHING
        if (realtime === "on") {
            update();
        }
        //REALTIME TOGGLE
        $("#realtime .btn").click(function () {
            if ($(this).data("toggle") === "on") {
                realtime = "on";
            }
            else {
                realtime = "off";
            }
            update();
        });
        /*
         * END INTERACTIVE CHART
         */

        $(".knob").knob({
            /*change : function (value) {
             //console.log("change : " + value);
             },
             release : function (value) {
             console.log("release : " + value);
             },
             cancel : function () {
             console.log("cancel : " + this.value);
             },*/
            "readOnly": true,
            draw: function () {

                // "tron" case
                if (this.$.data('skin') == 'tron') {

                    var a = this.angle(this.cv)  // Angle
                            , sa = this.startAngle          // Previous start angle
                            , sat = this.startAngle         // Start angle
                            , ea                            // Previous end angle
                            , eat = sat + a                 // End angle
                            , r = true;

                    this.g.lineWidth = this.lineWidth;

                    this.o.cursor
                    && (sat = eat - 0.3)
                    && (eat = eat + 0.3);

                    if (this.o.displayPrevious) {
                        ea = this.startAngle + this.angle(this.value);
                        this.o.cursor
                        && (sa = ea - 0.3)
                        && (ea = ea + 0.3);
                        this.g.beginPath();
                        this.g.strokeStyle = this.previousColor;
                        this.g.arc(this.xy, this.xy, this.radius - this.lineWidth, sa, ea, false);
                        this.g.stroke();
                    }

                    this.g.beginPath();
                    this.g.strokeStyle = r ? this.o.fgColor : this.fgColor;
                    this.g.arc(this.xy, this.xy, this.radius - this.lineWidth, sat, eat, false);
                    this.g.stroke();

                    this.g.lineWidth = 2;
                    this.g.beginPath();
                    this.g.strokeStyle = this.o.fgColor;
                    this.g.arc(this.xy, this.xy, this.radius - this.lineWidth + 1 + this.lineWidth * 2 / 3, 0, 2 * Math.PI, false);
                    this.g.stroke();

                    return false;
                }
            }
        });
        /* END JQUERY KNOB */

        //INITIALIZE SPARKLINE CHARTS
        $(".sparkline").each(function () {
            var $this = $(this);
            $this.sparkline('html', $this.data());
        });

        /* SPARKLINE DOCUMENTATION EXAMPLES http://omnipotent.net/jquery.sparkline/#s-about */
        drawDocSparklines();
        drawMouseSpeedDemo();
    });

    function drawDocSparklines() {

        // Bar + line composite charts
        $('#compositebar').sparkline('html', {type: 'bar', barColor: '#aaf'});
        $('#compositebar').sparkline([4, 1, 5, 7, 9, 9, 8, 7, 6, 6, 4, 7, 8, 4, 3, 2, 2, 5, 6, 7],
                {composite: true, fillColor: false, lineColor: 'red'});


        // Line charts taking their values from the tag
        $('.sparkline-1').sparkline();

        // Larger line charts for the docs
        $('.largeline').sparkline('html',
                {type: 'line', height: '2.5em', width: '4em'});

        // Customized line chart
        $('#linecustom').sparkline('html',
                {
                    height: '1.5em', width: '8em', lineColor: '#f00', fillColor: '#ffa',
                    minSpotColor: false, maxSpotColor: false, spotColor: '#77f', spotRadius: 3
                });

        // Bar charts using inline values
        $('.sparkbar').sparkline('html', {type: 'bar'});

        $('.barformat').sparkline([1, 3, 5, 3, 8], {
            type: 'bar',
            tooltipFormat: '{{value:levels}} - {{value}}',
            tooltipValueLookups: {
                levels: $.range_map({':2': 'Low', '3:6': 'Medium', '7:': 'High'})
            }
        });

        // Tri-state charts using inline values
        $('.sparktristate').sparkline('html', {type: 'tristate'});
        $('.sparktristatecols').sparkline('html',
                {type: 'tristate', colorMap: {'-2': '#fa7', '2': '#44f'}});

        // Composite line charts, the second using values supplied via javascript
        $('#compositeline').sparkline('html', {fillColor: false, changeRangeMin: 0, chartRangeMax: 10});
        $('#compositeline').sparkline([4, 1, 5, 7, 9, 9, 8, 7, 6, 6, 4, 7, 8, 4, 3, 2, 2, 5, 6, 7],
                {composite: true, fillColor: false, lineColor: 'red', changeRangeMin: 0, chartRangeMax: 10});

        // Line charts with normal range marker
        $('#normalline').sparkline('html',
                {fillColor: false, normalRangeMin: -1, normalRangeMax: 8});
        $('#normalExample').sparkline('html',
                {fillColor: false, normalRangeMin: 80, normalRangeMax: 95, normalRangeColor: '#4f4'});

        // Discrete charts
        $('.discrete1').sparkline('html',
                {type: 'discrete', lineColor: 'blue', xwidth: 18});
        $('#discrete2').sparkline('html',
                {type: 'discrete', lineColor: 'blue', thresholdColor: 'red', thresholdValue: 4});

        // Bullet charts
        $('.sparkbullet').sparkline('html', {type: 'bullet'});

        // Pie charts
        $('.sparkpie').sparkline('html', {type: 'pie', height: '1.0em'});

        // Box plots
        $('.sparkboxplot').sparkline('html', {type: 'box'});
        $('.sparkboxplotraw').sparkline([1, 3, 5, 8, 10, 15, 18],
                {type: 'box', raw: true, showOutliers: true, target: 6});

        // Box plot with specific field order
        $('.boxfieldorder').sparkline('html', {
            type: 'box',
            tooltipFormatFieldlist: ['med', 'lq', 'uq'],
            tooltipFormatFieldlistKey: 'field'
        });

        // click event demo sparkline
        $('.clickdemo').sparkline();
        $('.clickdemo').bind('sparklineClick', function (ev) {
            var sparkline = ev.sparklines[0],
                    region = sparkline.getCurrentRegionFields();
            value = region.y;
            alert("Clicked on x=" + region.x + " y=" + region.y);
        });

        // mouseover event demo sparkline
        $('.mouseoverdemo').sparkline();
        $('.mouseoverdemo').bind('sparklineRegionChange', function (ev) {
            var sparkline = ev.sparklines[0],
                    region = sparkline.getCurrentRegionFields();
            value = region.y;
            $('.mouseoverregion').text("x=" + region.x + " y=" + region.y);
        }).bind('mouseleave', function () {
            $('.mouseoverregion').text('');
        });
    }

    /**
     ** Draw the little mouse speed animated graph
     ** This just attaches a handler to the mousemove event to see
     ** (roughly) how far the mouse has moved
     ** and then updates the display a couple of times a second via
     ** setTimeout()
     **/
    function drawMouseSpeedDemo() {
        var mrefreshinterval = 500; // update display every 500ms
        var lastmousex = -1;
        var lastmousey = -1;
        var lastmousetime;
        var mousetravel = 0;
        var mpoints = [];
        var mpoints_max = 30;
        $('html').mousemove(function (e) {
            var mousex = e.pageX;
            var mousey = e.pageY;
            if (lastmousex > -1) {
                mousetravel += Math.max(Math.abs(mousex - lastmousex), Math.abs(mousey - lastmousey));
            }
            lastmousex = mousex;
            lastmousey = mousey;
        });
        var mdraw = function () {
            var md = new Date();
            var timenow = md.getTime();
            if (lastmousetime && lastmousetime != timenow) {
                var pps = Math.round(mousetravel / (timenow - lastmousetime) * 1000);
                mpoints.push(pps);
                if (mpoints.length > mpoints_max)
                    mpoints.splice(0, 1);
                mousetravel = 0;
                $('#mousespeed').sparkline(mpoints, {width: mpoints.length * 2, tooltipSuffix: ' pixels per second'});
            }
            lastmousetime = timenow;
            setTimeout(mdraw, mrefreshinterval);
        };
        // We could use setInterval instead, but I prefer to do it this way
        setTimeout(mdraw, mrefreshinterval);

    }
    var config1 = liquidFillGaugeDefaultSettings();
    config1.circleColor = "#FF7777";
    config1.textColor = "#FF4444";
    config1.waveTextColor = "#FFAAAA";
    config1.waveColor = "#FFDDDD";
    config1.circleThickness = 0.2;
    config1.textVertPosition = 0.2;
    config1.waveAnimateTime = 1000;
    var gauge0 = loadLiquidFillGauge("fillgauge0", 70, config1);

    var config2 = liquidFillGaugeDefaultSettings();
    config2.circleThickness = 0.2;
    config2.textVertPosition = 0.2;
    config2.waveAnimateTime = 1000;

    var gauge1 = loadLiquidFillGauge("fillgauge1", 85, config2);
    var gauge2 = loadLiquidFillGauge("fillgauge2", 80, config2);
    var gauge3 = loadLiquidFillGauge("fillgauge3", 83, config2);

    function NewValue() {
        if (Math.random() > .5) {
            return Math.round(Math.random() * 100);
        } else {
            return (Math.random() * 100).toFixed(1);
        }
    }
</script>
</body>
</html>
